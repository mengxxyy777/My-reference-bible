# 背包问题专题

## 简介

​	背包问题变种比较多，但是理解难度和实现难度不算大，重要的是从问题中找到对应条件，完成解题。

## 01背包问题

​	模板题：https://www.luogu.com.cn/problem/P1048

​	这是标准的01背包问题，所谓01背包，就是每件物品选与不选，每件物品有其对应的体积和价值，毕竟空间有限，想要最大化价值，需要一定的策略。

​	对于任意的物品，我们有两种选择：选与不选。定义这样的dp表：dp[i] [j]表示前i个物品体积为j时的最大价值。假设有n个物品，背包容量为T，最后返回dp[n] [T]即可。同时第0行的值dp[0] [j]应该都为0。

​	对于遍历到的第i个物品，如果不选，那么很明显此时最大价值为前i-1个物品体积为j的最大价值；如果选了，那么前i-1个物品需要保证体积为j-Vi的最大价值，再加上当前物品的价值。这样在两种情况下选择最大的即可。

## 01背包空间压缩

​	对于任意一个格子，它只依赖上一行的、该列和在该列之前的某个格子。故我们填好第一行后，每行从右往左遍历，可以保证左边能被用到的值都没被更新过。

## 练习题目

需要分析并转化

​	https://leetcode.cn/problems/tJau2o/

​	https://leetcode.cn/problems/target-sum/

​	https://leetcode.cn/problems/last-stone-weight-ii/

## 有依赖的01背包

​	多个物品进行绑定，同时互斥，即满足同一物品只被绑定在一个集合中。不要和怎么要的区别。

​	模板题：https://www.luogu.com.cn/problem/P1064

​	那么对于每个主件商品，才有第一步选择的必要。对于每个主件商品，分为几种情况：

​		1）不要该主件；

​		2）只要该主件；

​		3）要了主件后，只要附件1；

​		4）要了主件后，只要附件2；

​		5）要了主件后，附件1和2都要。

​	取最大值即可。

​	取以下几个辅助coding：

​		1）king数组，记录每个物品是不是主件；

​		2）fans数组，记录每个物品的附件数量；

​		3）follows数组，记录每个物品的附件编号；

​		4）p变量，记录上一个主件的编号，如果是空间压缩写法，则不需要该变量。

## 扩展题目

​	![image-20250110165618659](C:\Users\21702\AppData\Roaming\Typora\typora-user-images\image-20250110165618659.png)

​	01背包很明显，但是看数据量没法通过！！！

​	最优解是小根堆。

![image-20250110170636251](C:\Users\21702\AppData\Roaming\Typora\typora-user-images\image-20250110170636251.png)

## 分组背包

​	与01背包的区别是：物品被分成不同的几组，组间互斥。

​	模板题：https://www.luogu.com.cn/problem/P1757

​	按组遍历，每组选或不选，加一重循环，每组选的话，依次尝试。

​	时间复杂度同01背包。

## 练习题目

​	https://leetcode.cn/problems/maximum-value-of-k-coins-from-piles/

## 完全背包

​	与01背包的区别是：物品可以无限选，想选几个就选几个。

​	模板题：https://www.luogu.com.cn/problem/P1616

​	转移方程需要注意，不选当前物品，也就是选0个当前物品，那么需要第i-1个物品的信息；

​	如果选了当前物品，那么就不是从第i-1个物品转移过来了，而是第i个物品的状态转移过来，因为可能当前物品被选了好多次，每次扣掉当前物品的体积、加上当前物品的价值，前面的状态仍然可能是选择的当前物品！

## 练习题目

​	https://leetcode.cn/problems/regular-expression-matching/

​	https://leetcode.cn/problems/wildcard-matching/

​	https://www.luogu.com.cn/problem/P2918

## 多重背包

​	与01背包的区别是：物品有有限个数量。注意此条件与完全背包不同！！！

​	对于每件物品，需要多一次循环去枚举个数，将每种方案都计算出最小值，当数据量大的时候，会超时。

### 二进制分组优化

​	我们将依次枚举的过程优化掉，对于第i个物品，个数为c，那么我们按照1个、2个……m个分组，使之总体加起来是c个，这样我们按照01背包去枚举就可以了，2个物品的体积和价值认为是该物品的两倍……这样枚举是正确的，因为可以考虑到该物品取0-c个的所有情况，但是枚举的代价变为了log级别的，大大降低时间复杂度。

​	时间复杂度稍微大于O(n * t)，n是分组后的物品个数，t为容量。

### 单调队列优化

​	当来到第i个物品时，按当前物品重量取余分组求dp表，对于每组，求当前列和前面的i号物品的个数列，当中的最大值来更新当前的dp表，这个过程利用单调队列来优化。

​	注意单调队列的入队元素情况。每次入队对应下标内容会改变，我们直接用dp[i-1] [j] - 当前列j / mod来计算该指标。计算dp[i] [j]时，当前列也除以3，二者相加即可保证单调队列中的下标不变。

​	时间复杂度为严格的O(n * t)，比二进制分组优化稍微好一些，但是难度较大，对于本类问题来说，还是上面的更常用。

## 练习题目

​	https://www.luogu.com.cn/problem/P1776

​	https://www.luogu.com.cn/problem/P1833

## 混合背包

​	前面几种背包的混合使用，根据不同情况使用不同的dp。